<html>
<head>
    <title>Frames for FT graphics</title>
    <script type="text/javascript" src="styles.js"></script>
</head>
<body>
    <style>
        text{font-family:metric}
        
        .axis-web path{fill:none;}
        .axis-web text{fill:#111}
        .axis-web line{fill:none;stroke:#111;stroke-width:1px}
        
        .axis-soc path{fill:none;}
        .axis-soc text{fill:#fff}
        .axis-soc line{fill:none;stroke:#fff;stroke-width:1px}
        
        .axis-prt path{fill:none;}
        .axis-prt text{fill:#111}
        .axis-prt line{fill:none;stroke:#111;stroke-width:1px}
        
    </style>
    <script src="d3.min.js"></script>
    <!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.16/d3.js"></script>
    --> <script src="drawFrame.js"></script>
    <script src="line.js"></script>
    <script>
        
        //datafile
        var dataURL = "germany.csv"
        
        //titles, footnotes
        var title = "Political support in Germany";
        var subtitle = "Per cent";//comment out subtitle assignment if not needed
        var source = "Source: TNS-Emnid|FT graphic Bob Haslett";

        //Use the frames array to set unique values for each media type of frame
        var frames=[
        {name:"print",width:53.5,height:68,units:'mm',margins:[{top:5,right:5,bottom:5, left:3}],stylesheet:styleprint},
        {name:"web",width:600,height:422,units:'px',margins:[{top:7,right:5,bottom:5,left:5}],stylesheet:styleweb},
        {name:"social",width:600,height:300,units:'px',margins:[{top:0,right:10, bottom:5, left:10}],stylesheet:stylesoc},
        //{name:"video",width:1920,height:1080,units:'px',margins:[{top:80,right:207,bottom:50,left:207}],stylesheet:stylevid}
        ]
        
        //sets the padding inside the chart area
        var chartpading=[
        {name:"print",margin:[{top:5,right:20,bottom:0, left:0}]},
        {name:"web",margin:[{top:5,right:20,bottom:5, left:0}]},
        {name:"social",margin:[{top:0,right:25,bottom:5, left:0}]},
        {name:"video",margin:[{top:5,right:5,bottom:5, left:3}]}
        ]
        
        /*SHOULD NOT NEED TO CHANGE MUCH BELOW HERE*/
        for (var i=0;i<frames.length;i++){
            var sylename=frames[i].stylesheet;
            var media = frames[i].name;
            if(frames[i].units=="mm") {
                framewidth = mmToPx(frames[i].width);
                frameheight = mmToPx(frames[i].height);
            }
            else{
                framewidth = frames[i].width;
                frameheight = frames[i].height;
            }
            var framemargin = frames[i].margins[0];
            var titleYoffset=sylename.titleOffset;
            var subYoffset=sylename.subOffset
            var frame = new drawFrame(sylename.classes,media,titleYoffset,subYoffset)
                .width(framewidth)
                .height(frameheight)
                .margin(framemargin)
                .title(title)
                .source(source)
            //optional elements
            if (subtitle){
                frame.subtitle(subtitle)
            }
            d3.select("body").call(frame)
            //drawFrame

        }
        
        d3.csv(dataURL,function(error, data){
            //date formatter, matching the format of the incoming csv...
            //var parseDate = d3.time.format("%Y %b").parse;
            //var parseDate = d3.time.format("%Y").parse;//just full year
            var parseDate = d3.time.format("%d.%m.%Y").parse;
            /*
            some common formatting parsers....
            d3.time.format("%Y %b") 1986 Jan
            d3.time.format("%d-%b-%y")  28-Jan-86
            d3.time.format("%Y-%m-%d")  1986-01-28
            d3.time.format("%m/%d/%Y")  01/28/1986
            d3.time.format("%H:%M") 11:39
            d3.time.format("%H:%M %p")  11:39 AM
            d3.time.format("%B %d") January 28
            d3.time.format("%d %b") 28 Jan
             */

            //parse the data
            data.forEach(function(d) {
                d.date=parseDate(d.date);
            });

            for (var i=0;i<frames.length;i++){
                var stylename=frames[i].stylesheet;
                var media = frames[i].name;
                lineChart(data, stylename, media, chartpading);
            }   
        })//end data load
        
        function mmToPx(mm){
            var px = mm*2.83464480558843;
            return px;
        }
            
    </script>
</body>
</html>