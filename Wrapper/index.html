<html>
<head>
    <title>Frames for FT graphics</title>
    <script type="text/javascript" src="styles.js"></script>
</head>
<body>
    <style>
        text{font-family:metric}
        
        .axis-web path{fill:none;}
        .axis-web text{fill:#111}
        .axis-web line{fill:none;stroke:#111;stroke-width:1px}
        
        .axis-soc path{fill:none;}
        .axis-soc text{fill:#fff}
        .axis-soc line{fill:none;stroke:#fff;stroke-width:1px}
        
        .axis-prt path{fill:none;}
        .axis-prt text{fill:#111}
        .axis-prt line{fill:none;stroke:#111;stroke-width:1px}
        
    </style>
    <script src="d3.min.js"></script>
    <script src="FTonline.js"></script>
    <script src="FTprint.js"></script>
    <script src="FTsocial.js"></script>
    <script src="drawFrame.js"></script>
    <script>
        
        //datafile
        var dataURL = "changeme.csv"
        
        //titles, footnotes
        var title = "Trump! It's a comedy word in Britain";
        var subtitle = "Some Units and descriptions of measure go here and will wrap onto extra lines if needed";//comment out subtitle assignment if not needed
        var source = "Sources: various bits of research|FT graphic Liz Faunce|Other lines can be added using|a vertical pipe symbol";

        
        //choose editions
        var print = true,
            online = true,
            social = true

        var frames=[
        {name:"print",width:87,height:120,units:'mm',margins:[{top:3, right:5, left:3}],stylesheet:styleprint},
        {name:"web",width:600,height:400,units:'px',margins:[{top:4, left:5,right:5}],stylesheet:styleweb},
        {name:"social",width:600,height:300,units:'px',margins:[{top:0,left:10,right:10}],stylesheet:stylesoc}
        ]
        
        //online size
        var widthWeb = 600;
        var heightWeb = 400;
        var marginWeb = {
            left:5,
            right:5
        }
        //sets the padding inside the chart area - hoping we can automate this calculation
        var innerPaddingWeb = {
            left:20,
            right:10,
            top:0,
            bottom:40
        }
        
        //social media size
        var widthSocial = 600;
        var heightSocial = 300;
        var marginSocial = {
            left:10,
            right:10
        };
        var innerPaddingSocial = {
            left:30,
            right:14,
            top:0,
            bottom:26
        }
        
        //print size - all of these sizes are in mm
        var widthPrint = 87;
        var heightPrint = 120;
        var marginPrint = {
            left:3,
            right:3
        }
        var innerPaddingPrint = {
            left:6,
            right:3,
            top:0,
            bottom:7
        }
    
        /*SHOULD NOT NEED TO CHANGE MUCH BELOW HERE*/
        for (var i=0;i<frames.length;i++){
            var sylename=frames[i].stylesheet;
            var media = frames[i].name;
            if(frames[i].units=="mm") {
                framewidth = mmToPx(frames[i].width);
                frameheight = mmToPx(frames[i].height);
            }
            else{
                framewidth = frames[i].width;
                frameheight = frames[i].height;
            }
            var framemargin = frames[i].margins[0];
            var frame = new drawFrame(sylename,media)
                .width(framewidth)
                .height(frameheight)
                .margin(framemargin)
                .title(title)
                .source(source)
            //optional elements
            if (subtitle){
                frame.subtitle(subtitle)
            }
            d3.select("body").call(frame)
            //drawFrame

        }
        
        //convert print sizes
        widthPrint = mmToPx(widthPrint);
        heightPrint = mmToPx(heightPrint);
        marginPrint.left = mmToPx(marginPrint.left);
        marginPrint.right = mmToPx(marginPrint.right);
        
        d3.csv(dataURL,function(data){

            //web version
            var chartWeb = new webFrame(styleweb,"web")
                .width(widthWeb)
                .height(heightWeb)
                .margin(marginWeb)
                .title(title)
                .source(source)
            //optional elements
            if (subtitle){
                chartWeb.subtitle(subtitle)
            }
            
            //print version - all of these sizes are in mm
            var chartPrint = new printFrame(styleprint,"print")
                .width(widthPrint)
                .height(heightPrint)
                .margin(marginPrint)
                .title(title)
                .source(source)
            //optional elements
            if (subtitle){
                chartPrint.subtitle(subtitle)
            }
        
            //social media version
            var chartSocial = new socialFrame(stylesoc,"soc")
                .width(widthSocial)
                .height(heightSocial)
                .margin(marginSocial)
                .title(title)
                .source(source)

            //optional elements
            if (subtitle){
                chartSocial.subtitle(subtitle)
            }
            
           //call editions
            if (online){
                d3.select("body").call(chartWeb)
            }
            if (print){
                d3.select("body").call(chartPrint);
            }
            if (social){
                d3.select("body").call(chartSocial)
            }

           
            //select all charts and create things on them
            var charts = d3.selectAll(".chart");
                
            charts.each(function(d,i){
                
                //get content area
                var canvas = d3.select(this).select(".chart-canvas")

                console.log ("add the chart function in here")
                
            })
            
        })//end data load
        
        function mmToPx(mm){
            var px = mm*2.83464480558843;
            return px;
        }
        
        
     
        
    </script>
</body>
</html>